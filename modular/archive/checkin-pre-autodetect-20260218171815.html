<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Academic Allies â€“ Daily Check-In</title>
  <link rel="icon" href="/Academic-Allies/favicon.ico">
  <style>
    body {
      font-family: 'Atkinson Hyperlegible', 'OpenDyslexic', Arial, sans-serif;
      font-size: 16pt;
      line-height: 1.6;
      background: #FAFAF9;
      color: #333;
      min-height: 100vh;
      padding: 20px;
      margin: 0;
    }
    .checkin-container { max-width: 640px; margin: 0 auto; }
    .page-title { text-align: center; color: #6CA0A3; font-size: 22pt; margin-bottom: 6px; }
    .date-display { text-align: center; color: #888; font-size: 13pt; margin-bottom: 28px; }

    .card {
      background: white;
      border-radius: 18px;
      padding: 22px 24px;
      margin-bottom: 18px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .card h2 { color: #6CA0A3; font-size: 15pt; margin: 0 0 10px 0; }

    .reassurance {
      background: #f0f7f8;
      border-left: 4px solid #6CA0A3;
      border-radius: 0 10px 10px 0;
      padding: 10px 14px;
      font-size: 12pt;
      color: #555;
      margin-bottom: 14px;
      line-height: 1.5;
    }

    /* Yes / No / Skip buttons */
    .yn-row { display: flex; gap: 10px; flex-wrap: wrap; }
    .yn-btn {
      flex: 1;
      min-width: 80px;
      padding: 12px 10px;
      border: 2px solid #ddd;
      border-radius: 12px;
      font-size: 13pt;
      cursor: pointer;
      background: #f0f4f5;
      font-family: inherit;
      transition: all 0.18s;
      text-align: center;
    }
    .yn-btn:hover { background: #e0eced; border-color: #6CA0A3; }
    .yn-btn.selected-yes  { background: #d4edda; border-color: #28a745; color: #155724; }
    .yn-btn.selected-no   { background: #fff3cd; border-color: #ffc107; color: #856404; }
    .yn-btn.selected-red  { background: #f8d7da; border-color: #dc3545; color: #721c24; }
    .yn-btn.skip          { flex: 0 0 auto; background: #f8f8f8; color: #aaa; font-size: 11pt; border-color: #eee; }
    .yn-btn.skip:hover    { color: #777; border-color: #ccc; }

    /* Expandable checklist (for symptom question) */
    .symptom-list {
      display: none;
      margin-top: 14px;
      padding: 14px;
      background: #f8f8f8;
      border-radius: 12px;
    }
    .symptom-list.open { display: block; }
    .symptom-list label {
      display: flex; align-items: center; gap: 10px;
      font-size: 13pt; margin-bottom: 10px; cursor: pointer;
    }
    .symptom-list input[type="checkbox"] {
      width: 20px; height: 20px; accent-color: #6CA0A3; flex-shrink: 0;
    }

    /* Mood grid */
    .mood-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .mood-btn {
      background: #f0f4f5; border: 2px solid transparent;
      border-radius: 12px; padding: 12px 6px; font-size: 24pt;
      cursor: pointer; text-align: center; transition: all 0.18s;
      font-family: inherit;
    }
    .mood-btn:hover { background: #e0eced; }
    .mood-btn.selected { border-color: #6CA0A3; background: #e8f2f3; }
    .mood-label { display: block; font-size: 9pt; color: #555; margin-top: 3px; }

    /* "Have youâ€¦" checkboxes */
    .hyu-list { display: flex; flex-direction: column; gap: 12px; }
    .hyu-list label {
      display: flex; align-items: center; gap: 12px;
      font-size: 14pt; cursor: pointer;
    }
    .hyu-list input[type="checkbox"] {
      width: 22px; height: 22px; accent-color: #6CA0A3; flex-shrink: 0;
    }

    textarea {
      width: 100%; border: 2px solid #e0e0e0; border-radius: 10px;
      padding: 12px; font-family: inherit; font-size: 13pt;
      resize: vertical; min-height: 80px; box-sizing: border-box;
    }
    textarea:focus { border-color: #6CA0A3; outline: none; }

    /* Inline flag note (shows when No selected) */
    .flag-note {
      display: none; margin-top: 12px; font-size: 12pt;
      padding: 10px 14px; border-radius: 10px;
    }
    .flag-note.yellow { background: #fff3cd; color: #856404; }
    .flag-note.red    { background: #f8d7da; color: #721c24; }

    .save-btn {
      background: #6CA0A3; color: white; border: none;
      border-radius: 25px; padding: 14px 40px; font-size: 16pt;
      cursor: pointer; width: 100%; margin-top: 6px;
      min-height: 19mm; font-family: inherit;
    }
    .save-btn:hover { background: #5a8c8f; }
    .save-btn:active { transform: scale(0.98); }

    #savedMsg {
      display: none; text-align: center; padding: 14px 18px;
      border-radius: 14px; margin-top: 14px; font-size: 13pt;
    }

    /* Today's log */
    .log-title { color: #6CA0A3; font-weight: 600; font-size: 12pt; margin-bottom: 10px; }
    .log-entry {
      background: #f0f4f5; border-radius: 12px;
      padding: 10px 14px; margin-bottom: 8px; font-size: 11pt;
    }
  </style>
</head>
<body>
  <div id="site-header"></div>

  <div class="checkin-container">
    <h1 class="page-title">ğŸ“‹ Daily Check-In</h1>
    <p class="date-display" id="todayDate"></p>

    <!-- MOOD (supplemental, not in core spec) -->
    <div class="card">
      <h2>How are you feeling right now? ğŸ’­</h2>
      <div class="reassurance">This is just for your own tracking â€” no flags, no alerts. Skip it if you want.</div>
      <div class="mood-grid">
        <button class="mood-btn" onclick="selectMood(this,'Great')"     aria-label="Great">ğŸ˜„<span class="mood-label">Great</span></button>
        <button class="mood-btn" onclick="selectMood(this,'Good')"      aria-label="Good">ğŸ™‚<span class="mood-label">Good</span></button>
        <button class="mood-btn" onclick="selectMood(this,'Okay')"      aria-label="Okay">ğŸ˜<span class="mood-label">Okay</span></button>
        <button class="mood-btn" onclick="selectMood(this,'Tired')"     aria-label="Tired">ğŸ˜´<span class="mood-label">Tired</span></button>
        <button class="mood-btn" onclick="selectMood(this,'Anxious')"   aria-label="Anxious">ğŸ˜°<span class="mood-label">Anxious</span></button>
        <button class="mood-btn" onclick="selectMood(this,'Struggling')" aria-label="Struggling">ğŸ˜”<span class="mood-label">Struggling</span></button>
      </div>
    </div>

    <!-- QUESTION A: Symptoms -->
    <div class="card">
      <h2>A. Pain, fatigue, or brain fog today?</h2>
      <div class="reassurance">You don't need to answer this if you're not sure. If we notice signs of a bad brain day in the background, we'll note that for you. No action needed unless you want to add details.</div>
      <div class="yn-row">
        <button class="yn-btn" id="symptomsNo"   onclick="selectQ('symptoms','no')">âœ… No</button>
        <button class="yn-btn" id="symptomsYes"  onclick="selectQ('symptoms','yes')">ğŸ˜” Yes</button>
        <button class="yn-btn skip"              onclick="selectQ('symptoms','skip')">â­ Skip</button>
      </div>
      <div class="symptom-list" id="symptomChecklist">
        <strong style="font-size:12pt;color:#555;display:block;margin-bottom:10px;">Which ones? (check all that apply)</strong>
        <label><input type="checkbox" value="Headache"> Headache</label>
        <label><input type="checkbox" value="Muscle pain"> Muscle pain</label>
        <label><input type="checkbox" value="Joint pain"> Joint pain</label>
        <label><input type="checkbox" value="Severe tiredness/fatigue"> Severe tiredness / fatigue</label>
        <label><input type="checkbox" value="Trouble thinking/brain fog"> Trouble thinking / brain fog</label>
        <label><input type="checkbox" value="Dizziness"> Dizziness</label>
        <label><input type="checkbox" value="Nausea"> Nausea</label>
        <label><input type="checkbox" value="Other"> Other</label>
      </div>
    </div>

    <!-- QUESTION B: Sleep -->
    <div class="card">
      <h2>B. At least 6 hours of sleep last night?</h2>
      <div class="reassurance">You don't need to answer this if you're not sure. If you use a phone-based sleep app, this can be auto-logged eventually. No action needed unless you want to record it.</div>
      <div class="yn-row">
        <button class="yn-btn" id="sleepYes" onclick="selectQ('sleep','yes')">âœ… Yes</button>
        <button class="yn-btn" id="sleepNo"  onclick="selectQ('sleep','no')">âŒ No</button>
        <button class="yn-btn skip"          onclick="selectQ('sleep','skip')">â­ Skip</button>
      </div>
    </div>

    <!-- HAVE YOUâ€¦? (supplemental basics) -->
    <div class="card">
      <h2>Quick basics âœ…</h2>
      <div class="reassurance">No flags â€” just helpful to track for yourself and your team.</div>
      <div class="hyu-list">
        <label><input type="checkbox" id="ateToday">   Eaten something today</label>
        <label><input type="checkbox" id="drankWater"> Had water or fluids</label>
        <label><input type="checkbox" id="tookMeds">   Taken any needed meds</label>
      </div>
    </div>

    <!-- QUESTION C: Support connection -->
    <div class="card">
      <h2>C. Talked to someone on your support team today?</h2>
      <div class="reassurance">You don't need to answer this if you're not sure. If you skip, we'll just note that. No action needed unless you want to add details. (Bruise, Mom, a counselor, anyone counts.)</div>
      <div class="yn-row">
        <button class="yn-btn" id="supportYes" onclick="selectQ('support','yes')">âœ… Yes</button>
        <button class="yn-btn" id="supportNo"  onclick="selectQ('support','no')">âŒ Not yet</button>
        <button class="yn-btn skip"            onclick="selectQ('support','skip')">â­ Skip</button>
      </div>
      <div class="flag-note yellow" id="supportFlagNote">ğŸŸ¡ Noted â€” your team will know to check in with you.</div>
    </div>

    <!-- QUESTION D: Planner review -->
    <div class="card">
      <h2>D. Reviewed your calendar or planner today?</h2>
      <div class="reassurance">You don't need to answer this if you're not sure. If you skip, we'll just note that. No action needed unless you want to add details.</div>
      <div class="yn-row">
        <button class="yn-btn" id="plannerYes" onclick="selectQ('planner','yes')">âœ… Yes</button>
        <button class="yn-btn" id="plannerNo"  onclick="selectQ('planner','no')">âŒ Not today</button>
        <button class="yn-btn skip"            onclick="selectQ('planner','skip')">â­ Skip</button>
      </div>
    </div>

    <!-- QUESTION E: Emergency protocols -->
    <div class="card">
      <h2>E. Did you need emergency support today?</h2>
      <div class="reassurance">You don't need to answer this if you're not sure. If you skip, we'll just note that. No action needed unless you want to record it.</div>
      <div class="yn-row">
        <button class="yn-btn" id="emergencyNo"  onclick="selectQ('emergency','no')">âœ… No</button>
        <button class="yn-btn" id="emergencyYes" onclick="selectQ('emergency','yes')">ğŸš¨ Yes</button>
        <button class="yn-btn skip"              onclick="selectQ('emergency','skip')">â­ Skip</button>
      </div>
      <div class="flag-note red" id="emergencyFlagNote">ğŸ”´ Recorded. Please reach out right now â€” <a href="/Academic-Allies/modular/emergency.html" style="color:#721c24;font-weight:bold;">Emergency Contacts</a> or contact Bruise directly.</div>
    </div>

    <!-- NOTES -->
    <div class="card">
      <h2>Anything else to note? ğŸ“</h2>
      <div class="reassurance">Completely optional. Anything â€” how class went, what hurts, what you need, what's on your mind.</div>
      <textarea id="checkinNotes" placeholder="Type here, or leave it blankâ€¦"></textarea>
    </div>

    <button class="save-btn" onclick="saveCheckin()">Save Check-In âœ“</button>
    <div id="savedMsg"></div>
    <div id="todayLog" style="margin-top:28px;"></div>
  </div>

  <script>
    // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var selectedMood = '';
    var answers = { symptoms: '', sleep: '', support: '', planner: '', emergency: '' };
    var now = new Date();
    var dateKey = now.toISOString().split('T')[0];

    // Show date
    document.getElementById('todayDate').textContent = now.toLocaleDateString('en-US', {
      weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
    });

    // â”€â”€ Mood â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function selectMood(btn, mood) {
      selectedMood = mood;
      document.querySelectorAll('.mood-btn').forEach(function(b) { b.classList.remove('selected'); });
      btn.classList.add('selected');
    }

    // â”€â”€ Yes/No/Skip questions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var questionIds = {
      symptoms: ['symptomsNo', 'symptomsYes'],
      sleep:    ['sleepYes',   'sleepNo'],
      support:  ['supportYes', 'supportNo'],
      planner:  ['plannerYes', 'plannerNo'],
      emergency:['emergencyNo','emergencyYes']
    };

    function selectQ(group, answer) {
      answers[group] = answer;

      // Clear button styles for this group
      questionIds[group].forEach(function(id) {
        var btn = document.getElementById(id);
        if (btn) btn.className = 'yn-btn';
      });

      // Style the selected button
      if (answer === 'yes') {
        var yesId = questionIds[group][0]; // first = Yes (or No for symptoms/emergency which are reversed)
        // symptoms: No=first, Yes=second; sleep: Yes=first, No=second
        // support: Yes=first, No=second; planner: Yes=first, No=second; emergency: No=first, Yes=second
        var btnMap = {
          symptoms:  { yes: 'symptomsYes',  no: 'symptomsNo'  },
          sleep:     { yes: 'sleepYes',      no: 'sleepNo'     },
          support:   { yes: 'supportYes',    no: 'supportNo'   },
          planner:   { yes: 'plannerYes',    no: 'plannerNo'   },
          emergency: { yes: 'emergencyYes',  no: 'emergencyNo' }
        };
        var yesBtn = document.getElementById(btnMap[group].yes);
        var noBtn  = document.getElementById(btnMap[group].no);
        if (answer === 'yes' && yesBtn) yesBtn.className = (group === 'emergency') ? 'yn-btn selected-red' : 'yn-btn selected-yes';
        if (answer === 'no'  && noBtn)  noBtn.className  = (group === 'support' && answer === 'no') ? 'yn-btn selected-no' : 'yn-btn selected-no';
      } else if (answer === 'no') {
        var btnMap2 = {
          symptoms:  'symptomsNo',
          sleep:     'sleepNo',
          support:   'supportNo',
          planner:   'plannerNo',
          emergency: 'emergencyNo'
        };
        var btn2 = document.getElementById(btnMap2[group]);
        if (btn2) btn2.className = 'yn-btn selected-no';
      }

      // Symptom checklist toggle
      if (group === 'symptoms') {
        var cl = document.getElementById('symptomChecklist');
        cl.className = answer === 'yes' ? 'symptom-list open' : 'symptom-list';
      }

      // Support flag note
      if (group === 'support') {
        document.getElementById('supportFlagNote').style.display = (answer === 'no') ? 'block' : 'none';
      }

      // Emergency flag note
      if (group === 'emergency') {
        document.getElementById('emergencyFlagNote').style.display = (answer === 'yes') ? 'block' : 'none';
        var eYes = document.getElementById('emergencyYes');
        var eNo  = document.getElementById('emergencyNo');
        if (answer === 'yes') { if(eYes) eYes.className = 'yn-btn selected-red'; }
        else if (answer === 'no') { if(eNo) eNo.className = 'yn-btn selected-yes'; }
      }
    }

    // â”€â”€ Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function getTodayLog() {
      var raw = localStorage.getItem('checkins_' + dateKey);
      return raw ? JSON.parse(raw) : [];
    }

    function renderLog() {
      var log = getTodayLog();
      var container = document.getElementById('todayLog');
      if (log.length === 0) { container.innerHTML = ''; return; }
      var html = '<div class="log-title">Today\'s check-ins (' + log.length + ')</div>';
      log.slice().reverse().forEach(function(e) {
        var t   = new Date(e.savedAt).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
        var dot = e.flag === 'red' ? 'ğŸ”´' : e.flag === 'yellow' ? 'ğŸŸ¡' : 'ğŸŸ¢';
        html += '<div class="log-entry">' + dot + ' <strong>' + t + '</strong>';
        if (e.mood) html += ' â€” ' + e.mood;
        if (e.symptoms === 'yes' && e.symptomList && e.symptomList.length)
          html += '<br>Symptoms: ' + e.symptomList.join(', ');
        if (e.notes) html += '<br><span style="color:#555;">' + e.notes + '</span>';
        html += '</div>';
      });
      container.innerHTML = html;
    }

    renderLog();

    // â”€â”€ Save â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function saveCheckin() {
      // Determine overall flag
      var flag = 'green';
      if (answers.emergency === 'yes') flag = 'red';
      else if (answers.support === 'no') flag = 'yellow';

      // Collect symptom checklist
      var symptomList = [];
      if (answers.symptoms === 'yes') {
        document.querySelectorAll('#symptomChecklist input[type="checkbox"]:checked').forEach(function(cb) {
          symptomList.push(cb.value);
        });
      }

      var entry = {
        mood:        selectedMood,
        symptoms:    answers.symptoms,
        symptomList: symptomList,
        sleep:       answers.sleep,
        ate:         document.getElementById('ateToday').checked,
        water:       document.getElementById('drankWater').checked,
        meds:        document.getElementById('tookMeds').checked,
        support:     answers.support,
        planner:     answers.planner,
        emergency:   answers.emergency,
        flag:        flag,
        notes:       document.getElementById('checkinNotes').value,
        savedAt:     new Date().toISOString()
      };

      var log = getTodayLog();
      log.push(entry);
      localStorage.setItem('checkins_' + dateKey, JSON.stringify(log));

      // Show save message
      var msg = document.getElementById('savedMsg');
      if (flag === 'red') {
        msg.style.cssText = 'display:block;background:#f8d7da;color:#721c24;padding:14px;border-radius:14px;margin-top:14px;font-size:13pt;';
        msg.innerHTML = 'ğŸ”´ Check-in saved. Please reach out â€” <a href="/Academic-Allies/modular/emergency.html" style="color:#721c24;font-weight:bold;">Emergency Contacts</a> or contact Bruise now.';
      } else if (flag === 'yellow') {
        msg.style.cssText = 'display:block;background:#fff3cd;color:#856404;padding:14px;border-radius:14px;margin-top:14px;font-size:13pt;';
        msg.innerHTML = 'ğŸŸ¡ Check-in saved. Your team has been notified to check in with you.';
        setTimeout(function() { msg.style.display = 'none'; }, 6000);
      } else {
        msg.style.cssText = 'display:block;background:#e8f2f3;color:#2d6a6d;padding:14px;border-radius:14px;margin-top:14px;font-size:13pt;';
        msg.textContent = 'âœ” Check-in saved.';
        setTimeout(function() { msg.style.display = 'none'; }, 4000);
      }

      // Reset form
      selectedMood = '';
      answers = { symptoms: '', sleep: '', support: '', planner: '', emergency: '' };
      document.querySelectorAll('.mood-btn').forEach(function(b) { b.classList.remove('selected'); });
      document.querySelectorAll('.yn-btn').forEach(function(b) { b.className = b.classList.contains('skip') ? 'yn-btn skip' : 'yn-btn'; });
      document.getElementById('symptomChecklist').className = 'symptom-list';
      document.querySelectorAll('#symptomChecklist input[type="checkbox"]').forEach(function(cb) { cb.checked = false; });
      document.getElementById('supportFlagNote').style.display = 'none';
      document.getElementById('emergencyFlagNote').style.display = 'none';
      document.getElementById('ateToday').checked = false;
      document.getElementById('drankWater').checked = false;
      document.getElementById('tookMeds').checked = false;
      document.getElementById('checkinNotes').value = '';

      renderLog();
    }
  </script>

  <!-- Header loader -->
  <script>
    fetch('/Academic-Allies/modular/shared-header.html')
      .then(function(r) { return r.text(); })
      .then(function(html) {
        var c = document.getElementById('site-header');
        c.innerHTML = html;
        c.querySelectorAll('script').forEach(function(old) {
          var s = document.createElement('script');
          Array.from(old.attributes).forEach(function(a) { s.setAttribute(a.name, a.value); });
          s.textContent = old.textContent;
          old.replaceWith(s);
        });
        var d = document.createElement('script');
        d.src = '/Academic-Allies/modular/js/draggable.js';
        d.onload = function() { if (typeof initDrag === 'function') initDrag(); };
        document.body.appendChild(d);
      })
      .catch(function(e) { console.error('Header error:', e); });
  </script>
</body>
</html>
