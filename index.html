<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Allies - Your disability accommodations and support network</title>
    <link rel="icon" type="image/x-icon" href="/Academic-Allies/favicon.ico">
</head>
<body>
<header class="site-header" role="banner">
  <div class="header-content">
    <a aria-label="Home" class="home-link" href="/Academic-Allies/" title="Go Home">
    <img alt="Home" class="home-icon" src="/Academic-Allies/modular/icons/home.png" width="48" height="48" title="Academic Allies Home"/>
    </a>
      <span class="tagline" title="Academic Allies
Your disability accommodations and support network">Your disability accommodations and support network</span>
    <nav aria-label="Main navigation">
      <ul class="nav-list">
        <li><a href="/Academic-Allies/modular/components/calendar/calendar.html" title="Calendar">Calendar</a></li>
        <li><a href="/Academic-Allies/modular/emergency.html" title="Emergency Contact">Emergency Contact</a></li>
        <li><a href="/Academic-Allies/modular/checkin.html" title="Daily Check-In">Daily Check-In</a></li>
        <li><a href="/Academic-Allies/modular/icon-gallery.html" title="Icon Gallery">Icon Gallery</a></li>
        <li><a href="/Academic-Allies/modular/static/sitemap.html" title="Site Map">Site Map</a></li>
      </ul>
    </nav>

    <div class="header-controls">
      <!-- User Info Display (hidden until signed in) -->
      <div id="userInfoDisplay" style="display: none; margin-right: 10px;">
        <span id="userNameDisplay"></span>
      </div>

      <!-- Google Sign-In Container -->
      <div id="googleSignInContainer"></div>

      <!-- Sign Out Button (hidden until signed in) -->
      <button id="signOutButton" style="display: none;">Sign Out</button>

      <!-- JS-Draggable Status Circle -->
      <div aria-label="Status: Not signed in" id="status-circle" tabindex="0" title="Click to toggle status, drag to reorder"></div>
    </div>
  </div>

  <!-- Status Circle Container -->
  <div aria-live="polite" id="status-circle-container" role="status" title="Authentication Status"></div>

  <!-- Google Identity Services -->
  <script async defer src="https://accounts.google.com/gsi/client"></script>

  <!-- Google Sign-In JavaScript -->
  <script>
    // Check for existing session on page load
    window.onload = function() {
      // Check if user is already signed in
      const savedUser = sessionStorage.getItem('academicAlliesUser');
      if (savedUser) {
        const userData = JSON.parse(savedUser);
        updateUIForSignedInUser(userData);
      }

      // Initialize Google Sign-In
      google.accounts.id.initialize({
        client_id: '93996985456-ffj2euk9i4q41v88njuhpusk73mdb31j.apps.googleusercontent.com',
        callback: handleCredentialResponse
      });

      google.accounts.id.renderButton(
        document.getElementById('googleSignInContainer'),
        {
          theme: 'outline',
          size: 'medium',
          type: 'standard',
          shape: 'rectangular',
          logo_alignment: 'left',
          text: 'signin_with'
        }
      );

      // Set up sign out button
      document.getElementById('signOutButton').addEventListener('click', signOut);
    };

    function handleCredentialResponse(response) {
      console.log('User signed in successfully');
      
      // Decode the JWT token to get user info
      const base64Url = response.credential.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));
      
      const userData = JSON.parse(jsonPayload);
      console.log('User data:', userData);

      // Store user info in session
      sessionStorage.setItem('academicAlliesUser', JSON.stringify({
        name: userData.name,
        email: userData.email,
        picture: userData.picture,
        sub: userData.sub
      }));

      // Update UI
      updateUIForSignedInUser({
        name: userData.name,
        email: userData.email,
        picture: userData.picture
      });
    }

    function updateUIForSignedInUser(userData) {
      // Hide sign-in button
      document.getElementById('googleSignInContainer').style.display = 'none';
      
      // Show user info and sign out button
      document.getElementById('userInfoDisplay').style.display = 'block';
      document.getElementById('userNameDisplay').textContent = 'Welcome, ' + userData.name;
      document.getElementById('signOutButton').style.display = 'inline-block';
      
      // Update status circle
      const statusCircle = document.getElementById('status-circle');
      statusCircle.classList.add('signed-in');
      statusCircle.setAttribute('aria-label', 'Status: Signed in as ' + userData.name);
      statusCircle.title = 'Signed in as ' + userData.name;
    }

    function signOut() {
      // Clear session storage
      sessionStorage.removeItem('academicAlliesUser');
      
      // Reset UI
      document.getElementById('googleSignInContainer').style.display = 'block';
      document.getElementById('userInfoDisplay').style.display = 'none';
      document.getElementById('signOutButton').style.display = 'none';
      
      // Reset status circle
      const statusCircle = document.getElementById('status-circle');
      statusCircle.classList.remove('signed-in');
      statusCircle.setAttribute('aria-label', 'Status: Not signed in');
      statusCircle.title = 'Click to toggle status, drag to reorder';
      
      console.log('User signed out');
    }
  </script>
<script src="/Academic-Allies/modular/js/draggable.js"></script>
</header>
    <script>fetch("/Academic-Allies/modular/components/mode-switcher.html").then(r=>r.text()).then(h=>document.body.insertAdjacentHTML("afterbegin",h));</script>

<style>
.site-header {
  background: #f8f9fa;
  border-bottom: 1px solid #e1e5e9;
  padding: 12px 20px;
}

.header-content {
  justify-content: flex-start;
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
}

.home-link {
  display: flex;
  align-items: center;
  text-decoration: none;
  color: #333;
  font-weight: 600;
}

.home-link:hover {
  color: #0066cc;
}

.home-icon {
  margin-right: 8px;
}

.nav-list {
  display: flex;
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 20px;
}

.nav-list li {
  margin: 0;
}

.nav-list a {
  text-decoration: none;
  color: #555;
  font-weight: 500;
  padding: 8px 12px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.nav-list a:hover {
  background-color: #e9ecef;
  color: #333;
}

.header-controls {
  display: flex;
  align-items: center;
  gap: 15px;
}

#userInfoDisplay {
  font-weight: 500;
  color: #333;
}

#signOutButton {
  padding: 8px 16px;
  background-color: #dc3545;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 500;
}

#signOutButton:hover {
  background-color: #c82333;
}

#status-circle {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #dc3545;
  cursor: pointer;
  position: fixed; top: 16px; right: 16px; z-index: 1000;
  transition: background-color 0.3s;
}

#status-circle:hover {
  background-color: #c82333;
}

#status-circle.signed-in {
  background-color: #28a745;
}

#status-circle.signed-in:hover {
  background-color: #218838;
}

@media (max-width: 768px) {
  .header-content {
  justify-content: flex-start;
    gap: 15px;
  }

  .nav-list {
    flex-wrap: wrap;
    justify-content: flex-start;
    gap: 10px;
  }
}</style>
<main>
  <h1>Academic Allies - Available Modules</h1>
  <ul>
    <li><a href="/Academic-Allies/modular/accommodations.html">accommodations.html</a></li>
    <li><a href="/Academic-Allies/modular/calendar.html">calendar.html</a></li>
    <li><a href="/Academic-Allies/modular/checkin.html">checkin.html</a></li>
    <li><a href="/Academic-Allies/modular/emergency.html">emergency.html</a></li>
    <li><a href="/Academic-Allies/modular/google-integration.html">google-integration.html</a></li>
    <li><a href="/Academic-Allies/modular/icon-gallery.html">icon-gallery.html</a></li>
    <li><a href="/Academic-Allies/modular/resources.html">resources.html</a></li>
  </ul>
  <footer>
    <a href="/Academic-Allies/modular/static/docs/TEAM-PROFILES.md">About the Team</a><br>
    &copy; 2025 Academic Allies. Licensed under <a href="/Academic-Allies/LICENSE">MIT License</a>.<br>
    Auto-generated by CAj.<br><br>
    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 0.9em;">
      <a href="/Academic-Allies/modular/admin.html" style="margin-right: 15px;">Admin Page</a>
      <a href="#" onclick="signOut(); return false;" style="color: #dc3545;">Sign Out</a>
    </div>
  </footer>
</main>
</body>
</html>
